# 残酷学分！为了部落！

我们在做什么（一句话）
**残酷小队**：把“残酷共学”的活动积分上链，做成有团队协作增益与退出惩罚的游戏化积分系统。

### 核心要点

- **打卡用途**: 仅用于判定是否淘汰（当周缺勤>2 次淘汰），不直接给分。
- **积分来源**: 学员提交“完成学习任务”获取 **$IDO/$WEDO**，不同活动有不同基础分 $p$，例如分享学习笔记 40 分、参加一次晚会 5 分等。
- **发行方式**：学员在 Tally 表单自主提交记录 -> Webhook -> 服务器用私钥调用合约：给个人铸造 `IDO`，给团队金库记账 `WEDO`（不乘 L）。
- **分配机制**: 日常入账时，个人拿 $p$ $IDO；团队池拿 $p\times a$ 记为 `WEDO`。任意在籍成员可发起 `Withdraw`，按当前团队 $L_i$ 将 `WEDO` 转为 `IDO` 并“均分”给所有幸存成员（成员可随时 `claim`）。
- **团队增益 $L_i$**: 由“$当前在籍人数 R/初始人数 N0$”与平台阶段系数 $S$ 决定：$L_i(S, R)=S\times\big(L_{min}+(L_{max}-L_{min})\times\frac{R}{N_0}\big)$。
- **退出惩罚**: 被淘汰/离队后，不再参与后续 `Withdraw` 的均分；仍可领取淘汰前已累计的 `IDO`。
- **结算与领取**: 采用合约内“可领取”模型（非 Merkle）。成员可随时 `claim` 自己的累计 `IDO`。
- **公平与竞争**: 限制团队人数上限（建议 6），主榜看“人均分红”，辅榜看“当前 L 和团队总分”。

### 经济规则（双代币简述）

- **团队规模上限**：6（建议 4–6），初始编制记为 $N_0$，当前在籍（未淘汰）人数为 $R$。
- **活动积分（审核通过即入账）**：
  - 个人：$p \times \alpha$ → 铸造 `IDO` 给个人
  - 团队池：$p \times (1-\alpha)$ → 记为 `WEDO`（不乘 L）
- **`Withdraw` 转换**：按 $L_i(S,R)$ 将团队 `WEDO` 转为 `IDO`，并“按在籍人数均分”给幸存成员。
- **倍数 $L_i$ 的决定**（两种等价表现，选其一即可）：
  - 线性版（推荐，最简）：$L(R)=L_{min} + (L_{max}-L_{min}) \times \frac{R}{N_0}$  
    建议：$L_{min}=1.0,\ L_{max}=1.5$，并乘以平台阶段系数 $S$（由管理员按周配置）。
- **淘汰与资格**：打卡仅决定是否淘汰（例如一周缺勤>2 则淘汰），淘汰即时减少 $R$ 并失去分红资格；新加入可设 24–72h 冷静期后计入 $R$（防刷）。
- **分红结算**：在你设定的结算时点（天/周/月均可，与规则独立），未淘汰成员参与，按“结算期内个人活动分占比”瓜分团队池。
- **排行榜（凸显凝聚与竞争）**：
  - 主榜：人均分红排行（规模无关，更公平）
  - **辅榜：当前 $L(R)$ 排名、团队总分/人均总分**

例子：$N_0=6$，当前 $R=5$，且 $S=1$ → $L=1.0+(1.5-1.0)\times 5/6=1.4167$。  
成员提交活动 $p=20$：个人得 16 `IDO`；团队池 + $20\times 0.2=4$ `WEDO`。若随后 `Withdraw` 10 `WEDO`，则转为 $10\times 1.4167=14.167`IDO` 并按当下幸存人数均分。

### 退出处理（简化）

针对成员被残酷淘汰，团队分红池的再分配机制：

- 被淘汰后不再参与后续 `Withdraw` 的均分；仍可领取淘汰前已累计的 `IDO`。
- 不再设“退出再分配池”，均分逻辑在每次 `Withdraw` 时即时体现。

### 上链与成本（务实落地）

- 链选型：直接用测试网（Sepolia）演示。
- 交互成本：每次打卡都上链。采用“链上可领取”模式：
  - 每天打卡与团队池分摊先在后端/数据库记账，并调用合约入账 `IDO/WEDO`。
  - 任意成员可在合适时点发起 `Withdraw`，将团队 `WEDO` 转为 `IDO` 并累积到个人可领取额度。
  - 前端直接 `claim` 领取（极低 gas，体验好）。
- 代币模型：
  - MVP 用可转移 ERC20（OpenZeppelin），便于展示余额与排行榜。
  - 如果担心投机，可后续引入“不可转移积分 + 可转移治理/纪念凭证”的双代币架构（迭代再做）。

### 智能合约最小集合（MVP）

- IDOToken（ERC20）
  - 由经济合约铸造给个人，体现最终积分与排行。
- WEDOToken（ERC20）
  - 记录团队累积份额，仅在 `Withdraw` 时按 $L_i$ 转为 `IDO`。
- TeamManager
  - `createTeam` / `join` / `eliminate`（维护在籍人数 R、编制 N、参数 L_min/L_max，事件化变更）。
    - `join`（仅 DEMO，暂不实现）：首次参与需随交易附带 0.01 ETH（仅首次收取），该 ETH 计入全局 IDO 奖池；再次加入或团队间流转不重复收取。详见 `docs/IDO_POOL_DESIGN.md`。
- TeamEconomy（分配器）
  - `creditPersonalIDO` / `creditTeamWEDO` / `withdraw` / `claim`。
  - 采用“每幸存者累计分红”记账，成员可随时领取。

说明：详细机制、公式与接口以 [docs/tokenomics-v2.md](./tokenomics-v2.md) 为准；本文件仅作简要概述。

### 后端与防作弊

- 扫链缓存各种事件，方便前端显示。
- 数据来源：MVP 先支持“人工打卡 + 轻量证明”（截图/地理位置/打卡任务链接），管理员抽查；Hackathon 重点是机制演示。
- 防刷建议：（不需要）
  - 限制每日打卡上限与最小间隔。
  - 活跃天数门槛参与分红（见上）。
  - 行为分析：同 IP/同设备多号、极端节律等简单阈值拦截。
  - 后续可对接 GitHub/GFit/Apple Health/Notion 等真实数据源。

### UI/交互建议（高可玩且易实现）

- 圆桌总览（一个页面放多个小组）：
  - 中心：队旗、团队名、当前 L；旁边展示“本周团队池总量、已分发、未认领”。
  - 周围：成员头像环形排布。悬停显示“本周贡献、可领取分红、最近打卡时间”。
- 右侧活动流：
  - “谁在什么时候获得了多少积分”“当前 L 变化（有人退出/加入）”“本周分红 Top 3”。
- 领奖入口：
  - 顶部“本周可领取 X 代币”，点击弹出 Claim 面板。
- 细节动效：
  - 成员打卡时，中心冒出粒子飞向该成员与团队池，传达“L 倍 + 分红”的心智。

### 路线图（Hackathon 三步走）

- Day 1：定参数（$L$、$α$、活跃阈值）、完成 UI 原型、做本地记账和活动流。
- Day 2：部署测试网合约、（前端完成 Claim）。
- Day 3：打磨可视化、加退出降杠杆、加入最小防刷规则、准备 Demo 数据与讲解脚本。

### 关键指标（Demo 展示用）

- 团队留存率、成员活跃率（7 日内打卡 ≥ N 的比例）
- 团队池分红参与率、平均领取时延
- 单人贡献带动的“团队新增积分倍数”（p→p×L 的直观图）
- 退出事件对 L 的影响与团队活跃的联动图

---

# 宣传口径

版本一：精炼核心版（一句话讲清）
为高强度共学社群打造链上激励系统，采用“个人贡献+团队荣誉”双代币机制与动态博弈设计，彻底解决团队协作中的动力不均与成员退出难题，实现团队与个人利益的深度绑定。

版本二：市场宣传版（吸引参与者）
还在为团队“躺平”成员头疼？想让每一份努力都变得有价值？
“残酷共学”引入全新链上游戏化积分系统！
每次打卡学习，既能获得专属荣耀积分 IDO（I Do），又能为团队积累集体能量 WEDO（We Do）。
核心亮点：

- 团队增益：团队越团结，WEDO 兑换 IDO 汇率越高，大家收益倍增！
- 退出惩罚：提前退出会拉低团队兑换率，影响所有成员，退出需谨慎。
- 透明公正：所有数据上链，公开透明，每一份贡献都被精准记录并转化为实际价值。
  这不仅是学习挑战，更是团队智慧与凝聚力的试炼。加入我们，与优秀队友并肩前行，把汗水变成荣耀！

版本三：项目立项/融资版（突出创新与价值）
项目名称：Synergy Protocol —— 基于动态双代币模型的去中心化协作激励协议

1. 项目简介
   本项目聚焦协作学习及团队目标活动中的“公地悲剧”与“搭便车”难题，提出创新的区块链 gamified 激励系统。通过经济模型设计，促使个人努力与团队成功形成正向循环，提升团队凝聚力、参与度和目标达成率。

2. 核心机制

- 双代币经济模型（Dual-Token Economy）：
  - IDO（Individual Drive Offering）：个人贡献代币，完成任务（如学习打卡）获得，链上记录、不可篡改，量化个人努力。
  - WEDO（Team Drive Offering）：团队增益代币，成员获得 IDO 时团队按比例获得 WEDO，反映团队健康度与进度，可兑换为 IDO。
- 动态兑换率（Dynamic Conversion Rate）：WEDO 兑换 IDO 的汇率由算法动态调整，受团队活跃度、任务完成度、成员稳定性等多因素影响。高效团队享受更高汇率，低效则降低。
- 博弈与惩罚机制（Game Theory & Penalty）：成员退出或消极行为会稀释团队 WEDO 价值（降低兑换率），影响所有成员收益，激励团队内部自我监督，将外部管理压力转化为内生动力。

---

# 进一步计划（Further Plan）

以下内容为后续迭代方向，标记为“进一步计划（Further Plan）”，不属于当前 MVP 的必需范围。完整方案请参考对应文档链接。

### IDO 奖池与 ETH 质押（Further Plan 摘要）

- 目标：加入活动需质押 ETH，形成公共奖池；活动结束按结算快照时各地址持有的 `IDO` 占比分配 ETH。
- 资金流：
  - 质押：参与者 `depositETH`（默认 0.3 ETH，可配），直接进入奖池 `T`，到结算或退赛规则触发前不可取回。
  - 结算：在 `t_end` 做 `IDO` 快照，设符合资格的 `IDO` 总和为 `S`，某地址快照余额为 `b_i`，则其应得 `ETH = T × b_i / S`，采用链上“可领取”模型。
- 资格选项：
  - 默认推荐：持币即权益（结算时拥有 `IDO` 的任意地址参与）。
  - 可选：仅幸存者（仅未淘汰成员的地址参与）。
- 退出与异常：
  - 退赛退款策略可配（不退还/部分退还）；被淘汰的质押不退还；提供暂停与重试保护。
- 页面与交互：展示当前奖池、规则说明、预估奖励、我的面板与结算后的领取按钮；明确“以快照为准”。
- 配置项：`minDepositETH`、`eligibilityAtSettlement`、`refundRateOnQuit`、`allowExtraSponsors`、`endTimestamp` 等。
- 数据与事件（约束）：合约存储 `T`、状态、快照参数与 `claimableETH`，并事件化 `Staked/Sponsored/SnapshotTaken/Claimed/Quit`。

参见：[`docs/IDO_POOL_DESIGN.md`](./IDO_POOL_DESIGN.md)

### WEDO 商店（Team Shrine）（Further Plan 摘要）

- 定位：使用团队 `WEDO` 购买影响团队生态的功能道具，强化协作与策略深度，保持平衡性。
- 商品分类：
  - 激励增强类：团队之光（临时 +L）、学习狂热（积分效率 +20%）、凝聚力护盾（免淘汰）；个人效率药剂、保护结界等。
  - 复活重生类：重聚号角（召回淘汰成员）、血脉传承（恢复 L 的部分水平）、新生之种（重置 N0）；成员复活与记录恢复等。
  - 战略对抗类：挑战徽章（团队挑战）、侦查卷轴（窥视指标）、鼓舞战歌（免疫干扰）；干扰类如混乱法术、疲劳诅咒、窃能术等。
- 界面与交互：卡片橱窗、团队 `WEDO` 余额、道具详情与购买确认；重要道具需团队投票（>50%），部分道具有冷却与次数限制，效果需可视化展示与倒计时。
- 经济平衡：分层价格（基础/高级/战略），稀缺性（每日限购、等级解锁、季节限定），重复购买收益递减与反制机制。
- 团队策略影响：促进团队决策与资源分配博弈；对抗与合作并存，提供和平奖励、反女巫与防滥用的平衡设计。

参见：[`docs/wedo_store_shrine.md`](./wedo_store_shrine.md)
